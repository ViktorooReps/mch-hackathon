from feature_extraction.source_finder import *
import pandas as pd

def fake_detection(text, threshold = 0.5):
    model_kwargs = {
        'n_jobs': -1,
        'n_neighbors': 1
    }
    white_list = pd.read_pickle('white_list.pkl')
    sf = SourceFinder(white_list=white_list, model_kwargs=model_kwargs)
    article_info, distance = sf.find_source(text)
    return (article_info, distance)

text = 'В настоящее время уже более 365 материалов доступны в настоящее время в Главном архивном управлении Москвы, столичной Госинспекции по надзору за использованием недвижимого имущества."\n\n«Одним из важных достижений 2021 года стал проект “Уникальные документы”, который мы запустили с Госинспекцией по недвижимости ровно год назад. Благодаря нашей совместной работе удалось сохранить ценнейшие исторические материалы, среди которых чертежи, акварельные рисунки фасадов утраченных церквей и монастырей, нереализованные планы грандиозных советских построек. Все эти документы могут быть интересны архитекторам, историкам и всем горожанам, которые хотят узнать, как могла бы выглядеть столица. Кроме того, за это время мы включили в реестр уникальных документов гравюры XVIII века известных художников и военные материалы, которые также доступны на нашем сайте», — рассказал начальник Главного архивного управления города Москвы Ярослав Онопенко.\n\nНачальник Государственной инспекции недвижимости Владимир Овчинский заявил, что 2021-й год ознаменовал начало для департамента нового этап плодотворного взаимодействия с Главархивой.\n\n«Нам удалось провести масштабную работу с коллегами по выявлению документов, связанных с историческим обликом столицы, и открыть к ним свободный доступ. Теперь горожане могут узнать новые интересные факты об истории великого города, увидеть удивительные архитектурные проекты и чертежи Москвы, которые когда-то считались утерянными», — пояснил он.\n\nЗа первые несколько месяцев работы Главархива и Госинспекции по недвижимости были обнаружены все сохранившиеся до наших дней уникальные документы о 118 храмах, монастырях и часовнях Москвы. Эти архитектурные объекты были утрачены в 1920–1930-х годах, но их планы, чертежи, цветные акварельные рисунки фасадов теперь можно увидеть онлайн. Среди наиболее значимых опубликованных документов чертежи царских врат и план церкви Святой Екатерины Вознесенского девичьего монастыря в Кремле, возведенной в начале XIX века по проекту итальянского архитектора Карла Росси.\n\nТакже посредством проекта вы можете узнать и об деревянном храме Преподобного Сергея Радонежского в 1903 году, построенном в им. графа Сергея Шелестева.\n\nДокументы об утраченных в начале XX века храмах и часовнях Москвы теперь доступны онлайн\n\nНа сайте главархива удалось найти редкие материалы по грандиозным проектам советского времени, в том числе документы, касающиеся восьмой Сталинской высоты, пантеона и Дома колхозников на Каланчевском проспекте. Всего ценные материалы составили 47 рисунков, 89 фото и 39 листьев текста.\n\nВ числе выявленных документов проект пантеона — памятника вечной славы великих людей СССР, куда должны были переместить тела Владимира Ленина, Иосифа Сталина и других государственных деятелей, захороненных у Кремлевской стены. Для размещения пантеона предлагались самые разные места: Красная площадь, Поклонная гора, Ленинские (сейчас — Воробьевы) горы, Парк Горького, Софийская набережная, Рублевское шоссе, парк «Сокольники», Нескучный сад.\n\nКо Дню партизан и подпольщиков Главархив опубликовал документы 1941–1967 годов, сохранившиеся в фондах партийных организаций Москвы и посвященные Великой Отечественной войне. Наибольший интерес представляет отчет Московского областного комитета Всесоюзной коммунистической партии большевиков о деятельности партизанских отрядов и истребительно-диверсионных групп в районах Московской области, подвергшихся временной оккупации немецкими войсками. В документе есть сведения об организации партизанских отрядов, обеспечении их оружием и боеприпасами, о работе партизан на оккупированной территории Московской области, а также о том, как помогали им местные жители.\n\nГлавархив Москвы открыл доступ к уникальным гравюрам французских и итальянских мастеров\n\nВ сентябре Главархив Москвы совместно со специалистами Государственного музея изобразительных искусств имени А.С. Пушкина признал уникальными гравюры XVIII века. Их создали Жак-Филипп Леба, Томмазо Пироли и Джованни Баттиста Пиранези. В Главархив гравюры поступили в составе личного фонда архитектора Александра Власова, автора проектов Парка Горького, Крымского моста и спорткомплекса «Лужники». С 1950 по 1955 год он был главным архитектором Москвы.\n\n"Больше всего офортов, которые были представлены Главархивом, принадлежат авторам Джованни Паттиста Пиранези (Jovanni Battista Pianesi), итальянскому граверу, художнику и архитектору, одной из самых знаменитых мастеров живописи и офортов."\n\nКроме того, в разделе «Уникальные документы» можно увидеть и другие материалы, которые хранятся в Главархиве. В их числе уникальные документы с актовыми записями о рождении и бракосочетании Александра Пушкина, рождении Михаила Лермонтова, Федора Достоевского, Николая Пирогова, Сергея Соловьева, Бориса Пастернака, смерти Николая Гоголя, а также нотной рукописью Дмитрия Шостаковича.'
art_inf, dist = fake_detection(text)
print(art_inf['text'].values[0])
